(function(e){function t(t){for(var r,a,c=t[0],o=t[1],u=t[2],h=0,d=[];h<c.length;h++)a=c[h],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);l&&l(t);while(d.length)d.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,c=1;c<n.length;c++){var o=n[c];0!==i[o]&&(r=!1)}r&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},s=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dice-game/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=o;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"03cd":function(e,t,n){"use strict";n("67a1")},5738:function(e,t,n){"use strict";n("e0cd")},"67a1":function(e,t,n){},8654:function(e,t,n){"use strict";n("9061")},"8a5c":function(e,t,n){},9061:function(e,t,n){},"95f5":function(e,t,n){"use strict";n("8a5c")},a1e8:function(e,t,n){"use strict";n("a9d6")},a9d6:function(e,t,n){},b4bc:function(e,t,n){},bf38:function(e,t,n){"use strict";n("b4bc")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,i,s=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("game-over"),n("game-progress",{staticClass:"game-progress"}),n("game-board",{staticClass:"game-board"}),n("hr"),n("game-history",{staticClass:"game-history"})],1)},c=[],o=n("d4ec"),u=n("bee2"),l=n("262e"),h=n("2caf"),d=n("9ab4"),f=n("60a3"),m=(n("b0c0"),n("b85c")),v=(n("96cf"),n("1da1"));(function(e){function t(e){return null==e}function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Math.pow(10,t);return Math.round(e*n)/n}function r(e){return i(e)?null:e[e.length-1]}function i(e){return 0===e.length}e.isNullOrUndefined=t,e.round=n,e.getLastArrayItem=r,e.isEmpty=i})(r||(r={})),function(e){e.BASE_DICE_API_URL="http://roll.diceapi.com/json",e.ROLL_SINGLE_DICE="/d6",e.BASE_DICE_IMG_URL="http://roll.diceapi.com/images/poorly-drawn/d6/",e.QUESTION_MARK_IMG="https://cdn.pixabay.com/photo/2012/04/23/15/46/question-38629_960_720.png"}(i||(i={}));var p;n("99af"),n("d3b7");(function(e){e["GET"]="GET"})(p||(p={}));var b,y,g=function(){function e(t){Object(o["a"])(this,e),this.url="",this.options={},this.baseUrl=t}return Object(u["a"])(e,[{key:"get",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},n.method=p.GET,this.setRequestUrlAndOptions(t,n),e.next=5,this.getRequestResponse();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setRequestUrlAndOptions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url="".concat(this.baseUrl).concat(e),this.options=t}},{key:"getRequestResponse",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.url,this.options);case 2:if(t=e.sent,!this.isValidResponse(t)){e.next=10;break}return e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",{resource:n,response:t});case 10:throw new Error("Could not fetch data from url: ".concat(this.url,". Request finished with status code: ").concat(t.status));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isValidResponse",value:function(e){var t=e.status;return t>=200&&t<400}}]),e}(),_=function(){function e(){Object(o["a"])(this,e),this.rootElement=document.body,this.splashElement=document.createElement("div"),this.setUpSplash()}return Object(u["a"])(e,[{key:"addSplash",value:function(){this.rootElement.appendChild(this.splashElement)}},{key:"removeSplash",value:function(){this.rootElement.removeChild(this.splashElement)}},{key:"setUpSplash",value:function(){this.splashElement.style.position="fixed",this.splashElement.style.left="0",this.splashElement.style.top="0",this.splashElement.style.backgroundColor="black",this.splashElement.style.opacity="0.5",this.splashElement.style.zIndex="10",this.splashElement.style.width="100vw",this.splashElement.style.height="100vh"}}]),e}(),O=new g(i.BASE_DICE_API_URL),E=new _,I=new f["c"];(function(e){e["DICE_GAME_STATE"]="dice-game-state",e["GAME_OVER"]="game-over",e["DICE_GAME_STORE_READY"]="dice-game-store-ready"})(b||(b={})),function(e){e["MORE"]="MORE",e["LESS"]="LESS",e["START"]="START"}(y||(y={}));var S,D=function(){function e(t){var n=this;Object(o["a"])(this,e),this.setUp=function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t,s){var a,c,o,u,l,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(u=r.getLastArrayItem(t),r.isNullOrUndefined(u)||window.confirm("Load last game ?")||(n.clearDiceHistoryStore(),u=null),!r.isNullOrUndefined(u)){e.next=9;break}return e.next=5,O.get(i.ROLL_SINGLE_DICE);case 5:l=e.sent,h=l.resource,u={dice:h.dice[0].value,score:0,round:0,guess:y.START},n.addNewDiceHistoryItem({dice:u.dice,scoreDelta:0,guess:y.START});case 9:n.currentScore=null===(a=u)||void 0===a?void 0:a.score,n.currentRound=null===(c=u)||void 0===c?void 0:c.round,n.currentDice=null===(o=u)||void 0===o?void 0:o.dice,s(u),n.checkIsGameOver();case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.name=t}return Object(u["a"])(e,[{key:"dispose",value:function(){this.database.close()}},{key:"addNewDiceHistoryItem",value:function(e){var t=this.createDiceTransaction();if(this.currentDice=e.dice,r.isNullOrUndefined(this.currentRound)||r.isNullOrUndefined(this.currentScore))this.currentRound=0,this.currentScore=0;else{++this.currentRound;var n=this.currentScore+e.scoreDelta;this.currentScore=r.round(n,1)}var i={dice:this.currentDice,round:this.currentRound,score:this.currentScore,guess:e.guess};t.add(i),I.$emit(b.DICE_GAME_STATE,i),this.checkIsGameOver()}},{key:"getDiceGameHistory",value:function(){var e=this.createDiceTransaction();return e.getAll()}},{key:"clearDiceHistoryStore",value:function(){this.currentRound=null,this.currentScore=null;var e=this.createDiceTransaction();e.clear()}},{key:"initializeStore",value:function(e,t){var n=this,r=e.indexes,i=e.autoIncrement,s=e.storeName;this.storeName=s;var a=indexedDB.open(this.name,2);a.onerror=function(e){return console.error("An error occurred in **".concat(n.name,"** database"),e.target.errorCode)},a.onsuccess=function(){n.database=a.result;var e=n.getDiceGameHistory();e.onsuccess=Object(v["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.setUp(e.result,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})))},a.onupgradeneeded=function(){n.database=a.result;var e,t=n.database.createObjectStore(n.storeName,{autoIncrement:null===i||void 0===i||i}),s=Object(m["a"])(r);try{for(s.s();!(e=s.n()).done;){var c=e.value,o=c.key,u=c.isUnique;t.createIndex(o,o,{unique:u})}}catch(l){s.e(l)}finally{s.f()}}}},{key:"createDiceTransaction",value:function(){var e=this.database.transaction([this.storeName],"readwrite");return e.onerror=function(e){return console.error("An error occurred in **transaction**",e.target.errorCode)},e.objectStore(this.storeName)}},{key:"checkIsGameOver",value:function(){30===this.currentRound&&I.$emit(b.GAME_OVER,this.currentScore)}}]),e}(),j=new D("DiceStore"),G={storeName:"DiceHistory",indexes:[{key:"round",isUnique:!0},{key:"score",isUnique:!1},{key:"dice",isUnique:!1},{key:"guess",isUnique:!1}],autoIncrement:!0},R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"game-board"},[n("dice-card",{staticClass:"game-board__next-dice",attrs:{"image-source":e.nextDiceImg}}),n("section",{staticClass:"game-board__guess"},[n("base-button",{attrs:{content:"Less"},on:{click:e.handleGuessIfLess}}),n("dice-card",{attrs:{"image-source":e.currentDiceImg}}),n("base-button",{attrs:{content:"More"},on:{click:e.handleGuessIfMore}})],1)],1)},k=[],w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.getSizeClass},[n("img",{attrs:{src:e.imageSource,alt:"dice"}})])},A=[];(function(e){e["S"]="s",e["M"]="m"})(S||(S={}));var M=function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(u["a"])(n,[{key:"getSizeClass",get:function(){return this.$props.size===S.M?S.M:S.S}}]),n}(f["c"]);Object(d["a"])([Object(f["b"])()],M.prototype,"imageSource",void 0),Object(d["a"])([Object(f["b"])({default:S.M})],M.prototype,"size",void 0),M=Object(d["a"])([f["a"]],M);var T=M,x=T,C=(n("bf38"),n("2877")),U=Object(C["a"])(x,w,A,!1,null,"6a8d07dc",null),L=U.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",e._g({},e.$listeners),[e._v(e._s(e.content))])},H=[],$=function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return n}(f["c"]);Object(d["a"])([Object(f["b"])()],$.prototype,"content",void 0),$=Object(d["a"])([f["a"]],$);var z=$,B=z,q=(n("a1e8"),Object(C["a"])(B,N,H,!1,null,"d1cba9c8",null)),P=q.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("strong",[e._v(e._s(e.round))]),n("b",[e._v("|")]),n("strong",[e._v(e._s(e.score))])])},Y=[],F=function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.call(this),e.currentRound=0,e.currentScore=0,e.initializeSubscriptions(),e}return Object(u["a"])(n,[{key:"beforeDestroy",value:function(){I.$off(b.DICE_GAME_STATE,this.setGameState)}},{key:"initializeSubscriptions",value:function(){I.$on(b.DICE_GAME_STATE,this.setGameState)}},{key:"setGameState",value:function(e){var t=e.score,n=e.round;this.currentRound=n,this.currentScore=t}},{key:"round",get:function(){return"Round: ".concat(this.currentRound)}},{key:"score",get:function(){return"Score: ".concat(this.currentScore)}}]),n}(f["c"]);F=Object(d["a"])([f["a"]],F);var K=F,Q=K,J=(n("fa59"),Object(C["a"])(Q,V,Y,!1,null,"18fa2f33",null)),W=J.exports,X=function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.call(this),e.nextDice=i.QUESTION_MARK_IMG,e.currentDice=i.QUESTION_MARK_IMG,e.initializeSubscriptions(),e}return Object(u["a"])(n,[{key:"beforeDestroy",value:function(){I.$off(b.DICE_GAME_STATE,this.setGameState)}},{key:"handleGuessIfLess",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=y.LESS,e.next=3,O.get(i.ROLL_SINGLE_DICE);case 3:n=e.sent.resource.dice[0].value,r=0,n<j.currentDice&&(r=.1),this.handleGuessResult(n,r,t);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleGuessIfMore",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=y.MORE,e.next=3,O.get(i.ROLL_SINGLE_DICE);case 3:n=e.sent.resource.dice[0].value,r=0,n>j.currentDice&&(r=.1),this.handleGuessResult(n,r,t);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleGuessResult",value:function(e,t,n){var r={dice:e,scoreDelta:t,guess:n};j.addNewDiceHistoryItem(r),this.changeDiceImages(e)}},{key:"changeDiceImages",value:function(e){this.currentDice="".concat(i.BASE_DICE_IMG_URL).concat(e,".png"),this.nextDice=i.QUESTION_MARK_IMG}},{key:"initializeSubscriptions",value:function(){I.$on(b.DICE_GAME_STATE,this.setGameState)}},{key:"setGameState",value:function(e){var t=e.dice;this.currentDice="".concat(i.BASE_DICE_IMG_URL).concat(t,".png")}},{key:"currentDiceImg",get:function(){return this.currentDice}},{key:"nextDiceImg",get:function(){return this.nextDice}}]),n}(f["c"]);Object(d["a"])([Object(f["b"])()],X.prototype,"msg",void 0),X=Object(d["a"])([Object(f["a"])({components:{GameProgress:W,BaseButton:P,DiceCard:L}})],X);var Z=X,ee=Z,te=(n("5738"),Object(C["a"])(ee,R,k,!1,null,"515aeeb4",null)),ne=te.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("details",[e._m(0),n("ul",e._l(e.availableHistoryItems,(function(t){return n("li",{key:t.round},[n("b",[e._v(e._s(e.buildRound(t)))]),n("dice-card",{attrs:{size:e.getDiceCardSize(),"image-source":e.getHistoryItemDiceImgUrl(t.dice)}}),n("b",[e._v(e._s(e.getDiceGuess(t)))]),n("dice-card",{attrs:{size:e.getDiceCardSize(),"image-source":e.getNextHistoryItemDiceImgUrl(t)}}),n("b",[e._v(e._s(e.getScoreAfterGuess(t)))])],1)})),0)])},ie=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("summary",[n("b",[e._v("Game history")])])}],se=(n("4de4"),function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.call(this),e.historyItems=[],e.initializeSubscriptions(),e}return Object(u["a"])(n,[{key:"beforeDestroy",value:function(){I.$off(b.DICE_GAME_STATE,this.addNewHistoryItem),I.$off(b.DICE_GAME_STORE_READY,this.setUpHistoryItems)}},{key:"hasMoreThanOneItem",value:function(){return this.historyItems.length>1}},{key:"isNotLastHistoryItem",value:function(e){var t;return e.round!==(null===(t=r.getLastArrayItem(this.historyItems))||void 0===t?void 0:t.round)}},{key:"getDiceCardSize",value:function(){return S.S}},{key:"buildRound",value:function(e){var t=e.round;return"Round: ".concat(t)}},{key:"getHistoryItemDiceImgUrl",value:function(e){return"".concat(i.BASE_DICE_IMG_URL).concat(e,".png")}},{key:"getNextHistoryItemDiceImgUrl",value:function(e){return"".concat(i.BASE_DICE_IMG_URL).concat(this.getFollowingItem(e).dice,".png")}},{key:"getDiceGuess",value:function(e){return this.getFollowingItem(e).guess}},{key:"getScoreAfterGuess",value:function(e){return"Score: ".concat(this.getFollowingItem(e).score)}},{key:"getFollowingItem",value:function(e){var t=e.round;return this.historyItems[t+1]}},{key:"initializeSubscriptions",value:function(){I.$on(b.DICE_GAME_STATE,this.addNewHistoryItem),I.$on(b.DICE_GAME_STORE_READY,this.setUpHistoryItems)}},{key:"setUpHistoryItems",value:function(){var e=this,t=j.getDiceGameHistory();t.onsuccess=function(){return e.historyItems=t.result}}},{key:"addNewHistoryItem",value:function(e){var t;0===e.round&&(this.historyItems=[]),(r.isEmpty(this.historyItems)||e.round!==(null===(t=r.getLastArrayItem(this.historyItems))||void 0===t?void 0:t.round))&&this.historyItems.push(e)}},{key:"availableHistoryItems",get:function(){var e=this;return this.hasMoreThanOneItem()?this.historyItems.filter((function(t){return e.isNotLastHistoryItem(t)})):[]}}]),n}(f["c"]));se=Object(d["a"])([Object(f["a"])({components:{DiceCard:L}})],se);var ae=se,ce=ae,oe=(n("03cd"),Object(C["a"])(ce,re,ie,!1,null,"74449de2",null)),ue=oe.exports,le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.showGameOver,expression:"showGameOver"}]},[n("h3",[e._v("Game over!")]),n("b",[e._v(e._s("Your score "+e.totalScore))]),n("base-button",{attrs:{content:"Start new game"},on:{click:e.startNewGame}})],1)},he=[],de=function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.call(this),e.showGameOver=!1,e.gameScore=0,e.initializeSubscriptions(),e}return Object(u["a"])(n,[{key:"beforeDestroy",value:function(){I.$off(b.GAME_OVER,this.handleGameOver)}},{key:"handleGameOver",value:function(e){this.gameScore=e,this.showGameOver=!0,E.addSplash()}},{key:"initializeSubscriptions",value:function(){I.$on(b.GAME_OVER,this.handleGameOver)}},{key:"startNewGame",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return j.clearDiceHistoryStore(),e.next=3,O.get(i.ROLL_SINGLE_DICE);case 3:t=e.sent.resource.dice[0].value,j.addNewDiceHistoryItem({guess:y.START,scoreDelta:0,dice:t}),this.showGameOver=!1,E.removeSplash();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"totalScore",get:function(){return this.gameScore}}]),n}(f["c"]);de=Object(d["a"])([Object(f["a"])({components:{BaseButton:P}})],de);var fe=de,me=fe,ve=(n("8654"),Object(C["a"])(me,le,he,!1,null,"53b3dc74",null)),pe=ve.exports,be=function(e){Object(l["a"])(n,e);var t=Object(h["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.setUpGameData=function(e){I.$emit(b.DICE_GAME_STATE,e),I.$emit(b.DICE_GAME_STORE_READY)},e}return Object(u["a"])(n,[{key:"mounted",value:function(){j.initializeStore(G,this.setUpGameData)}}]),n}(f["c"]);be=Object(d["a"])([Object(f["a"])({components:{GameOver:pe,GameProgress:W,GameHistory:ue,GameBoard:ne}})],be);var ye=be,ge=ye,_e=(n("95f5"),Object(C["a"])(ge,a,c,!1,null,"4aa0feec",null)),Oe=_e.exports;n("fb98");s["a"].config.productionTip=!1,new s["a"]({render:function(e){return e(Oe)}}).$mount("#app")},e0cd:function(e,t,n){},eb9e:function(e,t,n){},fa59:function(e,t,n){"use strict";n("eb9e")},fb98:function(e,t,n){}});
//# sourceMappingURL=app.a96b480e.js.map